<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Local Test - Kanagala Family Tree</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }

        .test-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .success {
            color: #4caf50;
        }

        .error {
            color: #f44336;
        }

        .info {
            color: #2196f3;
        }
    </style>
</head>

<body>
    <h1>üß™ Local Testing - Family Tree</h1>

    <div class="test-box">
        <h2>Status Check</h2>
        <div id="status">Testing...</div>
    </div>

    <div class="test-box">
        <h2>Console Output</h2>
        <div id="console"
            style="background: #f5f5f5; padding: 10px; border-radius: 4px; font-family: monospace; font-size: 12px;">
        </div>
    </div>

    <div class="test-box">
        <h2>Family Data Preview</h2>
        <div id="preview"></div>
    </div>

    <script>
        const statusDiv = document.getElementById('status');
        const consoleDiv = document.getElementById('console');
        const previewDiv = document.getElementById('preview');

        function log(msg, type = 'info') {
            const color = type === 'error' ? '#f44336' : type === 'success' ? '#4caf50' : '#666';
            consoleDiv.innerHTML += `<div style="color: ${color};">${new Date().toLocaleTimeString()}: ${msg}</div>`;
            console.log(msg);
        }

        async function testLoad() {
            try {
                log('üìÅ Attempting to load details.json...', 'info');
                statusDiv.innerHTML = '<span class="info">‚è≥ Loading...</span>';

                const response = await fetch('./details.json');
                log(`‚úì Fetch response: ${response.status} ${response.statusText}`, 'success');

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const jsonData = await response.json();
                log('‚úì JSON parsed successfully', 'success');

                // Check structure
                const data = jsonData.kanagala || jsonData.members || jsonData;

                if (!Array.isArray(data)) {
                    throw new Error('Data is not an array. Found: ' + typeof data);
                }

                log(`‚úì Found ${data.length} family members`, 'success');

                // Show preview
                const sample = data.slice(0, 3);
                previewDiv.innerHTML = `
                    <p><strong>Total Members:</strong> ${data.length}</p>
                    <p><strong>First 3 members:</strong></p>
                    <pre style="background: #f5f5f5; padding: 10px; border-radius: 4px; overflow: auto;">${JSON.stringify(sample, null, 2)}</pre>
                `;

                statusDiv.innerHTML = '<span class="success">‚úÖ SUCCESS! Everything is working!</span>';
                log('üéâ All tests passed!', 'success');

            } catch (error) {
                log(`‚ùå Error: ${error.message}`, 'error');
                statusDiv.innerHTML = `<span class="error">‚ùå FAILED: ${error.message}</span>`;
                previewDiv.innerHTML = `
                    <div style="color: #f44336; padding: 20px; background: #ffebee; border-radius: 4px;">
                        <h3>‚ö†Ô∏è Test Failed</h3>
                        <p><strong>Error:</strong> ${error.message}</p>
                        <p style="margin-top: 10px;"><strong>Possible fixes:</strong></p>
                        <ul>
                            <li>Make sure details.json exists in the same folder</li>
                            <li>Open this file via http:// (not file://)</li>
                            <li>Check browser console (F12) for more details</li>
                        </ul>
                    </div>
                `;
            }
        }

        // Run test on load
        testLoad();
    </script>
</body>

</html>